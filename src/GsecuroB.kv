#:import Factory kivy.factory.Factory

<ColorPopup@Popup>:
    auto_dismiss: False
    title:"Other Colors"
    size_hint:(.6,.5)
    pos:root.pos
    spacing:10
    BoxLayout:
        pos_hint_y:(1)
        orientation:'vertical'
        MDSeparator:
            width:5

        GridLayout:
            spacing:20
            cols:2
            rows:8
            size_hint:(None,.8)
            pos_hint_y:.7
            width:'50dp'
            MDRectangleFlatButton:
                id:pinkbtn
                text:"Pink"
                text_color: "white"
                line_color: "pink"
                line_width: 2
                on_release:
                    app.changePColor('1')
            MDRectangleFlatButton:
                id:purple2btn
                text:"Purple 2"
                text_color: "white"
                line_color: "purple"
                line_width: 2
                on_release:
                    app.changePColor('2')
            MDRectangleFlatButton:
                id:indigobtn
                text:"Indigo"
                text_color: "white"
                line_color: "indigo"
                line_width: 2
                on_release:
                    app.changePColor('4')
            MDRectangleFlatButton:
                id:lbluebtn
                text:"LBlue"
                text_color: "white"
                line_color: "lightblue"
                line_width: 2
                on_release:
                    app.changePColor('6')
            MDRectangleFlatButton:
                id:cyanbtn
                text:"Cyan"
                text_color: "white"
                line_color: (0/255,255/255,255/255,1)
                line_width: 2
                on_release:
                    app.changePColor('7')
            MDRectangleFlatButton:
                id:tealbtn
                text:"Teal"
                text_color: "white"
                line_color: (0/255,128/255,128/255,1)
                line_width: 2
                on_release:
                    app.changePColor('8')
            MDRectangleFlatButton:
                id:lgreenbtn
                text:"LGreen"
                text_color: "white"
                line_color: (144/255, 238/255, 144/255,1)
                line_width: 2
                on_release:
                    app.changePColor('10')
            MDRectangleFlatButton:
                id:limebtn
                text:"Lime"
                text_color: "white"
                line_color: "lime"
                line_width: 2
                on_release:
                    app.changePColor('11')
            MDRectangleFlatButton:
                id:yellowbtn
                text:"Yellow"
                text_color: "white"
                line_color: "green"
                line_width: 2
                on_release:
                    app.changePColor('12')
            MDRectangleFlatButton:
                text:"Amber"
                text_color: "white"
                line_color: (255/255, 194/255, 0/255,1)
                line_width: 2
                on_release:
                    app.changePColor('13')
            MDRectangleFlatButton:
                text:"Orange2"
                text_color: "white"
                line_color: "orange"
                line_width: 2
                on_release:
                    app.changePColor('14')
            MDRectangleFlatButton:
                text:"Brown"
                text_color: "white"
                line_color: "brown"
                line_width: 2
                on_release:
                    app.changePColor('16')
            MDRectangleFlatButton:
                text:"Gray"
                text_color: "white"
                line_color: "gray"
                line_width: 2
                on_release:
                    app.changePColor('17')
            MDRectangleFlatButton:
                text:"BlueGray"
                text_color: "white"
                line_color: (112/255,128/255,144/255,1)
                line_width: 2
                on_release:
                    app.changePColor('18')


        Button:
            text: 'Close'
            size_hint_y:.1
            on_release: root.dismiss()

<StackButtonMenu@MDFloatingActionButton>
    pos: self.parent.center_x - self.width /2 , "50dp"

<StackButtonPm@MDFloatingActionButton>
    pos: "20dp" , "20dp" 

<ClickableTextFieldRound>:
    size_hint_y: None
    height: text_field.height
    text:text_field.text

    MDTextField:
        id: text_field
        hint_text: root.hint_text
        max_text_length: 99
        text: root.text
        password: True

    MDIconButton:
        icon: "eye-off"
        pos_hint: {"center_y": .5}
        pos: text_field.width - self.width + dp(8), 0
        theme_text_color: "Hint"
        on_release:
            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
            text_field.password = False if text_field.password is True else True



ScreenManager:
    MenuScreen:
    PMScreen:
    SettsScreen:
    SeedScreen:


<ScreenManager>:
    canvas.before:
        Color:
            rgba: (53/255,57/255,60/255,1)
        Rectangle:
            pos: self.pos
            size: self.size

<MenuScreen>:
    name:'menu'
    canvas.before:
        Color:
            rgba: (53/255,57/255,60/255,1)
        Rectangle:
            pos: self.pos
            size: self.size
    MDIconButton:
        pos_hint:{"top":1,"right":1}
        icon: 'cog'
        on_release:
            root.manager.transition.is_active = False
            root.manager.transition.duration = 0
            root.manager.current = "setts"

        

    StackButtonMenu:
        id: btnPm
        icon: "table-lock"
        on_release: 
            root.anim_btn()
            root.manager.transition.is_active = False
            root.manager.transition.duration = 0
            root.manager.current = "pm"

    StackButtonMenu:
        id: btnBlockChain
        type: "small"
        icon: "link-variant"
        on_press:root.WaitPopup()

    StackButtonMenu:
        id: btnSeedPhrase
        type: "small"
        icon: "seed-outline"
        on_release: 
            root.anim_btn()
            root.manager.transition.is_active = False
            root.manager.transition.duration = 0
            root.manager.current = "seed"

    RootButton:
        id: btn_root_menu
        icon: "menu"
        elevation: 0
        pos_hint: {"center_x": .5}
        y: "50dp"
        md_bg_color: app.theme_cls.primary_dark
        on_release: root.anim_btn()


<PMScreen>:
    name: 'pm'
    id:pm
    canvas.before:
        Color:
            rgba: (53/255,57/255,60/255,1)
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        pos_hint:{'y':.465}
        halign: 'center'
        size: root.size
        Label:
            text: "Password Manager"
            halign: 'center'
            font_size:80
            bold: True
            color:  (1,1,1,1)        #(255/255,153/255,0/255,1)
            outline_width: 1
            outline_color: (0,0,0)
    MDSeparator:
        pos_hint:{'y':.935}
        width:2
        color: (255/255,1,1,1)


    ClickableTextFieldRound:
        id:mainPassword  
        size_hint_x: .45
        #width: 500
        pos_hint:{'x':.05, 'y':.86}
        hint_text:"Main Password"
        

    GridLayout:
        orrientation: "horizontal"
        cols:2
        spacing: 15
        pos_hint:{'x':.55,'top':.924}


        MDRectangleFlatButton:
            id: browseDatabaseBtn
            text: "Browse"
            on_press:root.loadfile_manager_open()
        MDRectangleFlatButton:
            id: openTreeviewBtn
            text: "Open"
            on_release:root.openDbcToTable()
    
    BoxLayout:
        spacing:10
        pos_hint:{'y':.825,'x':.194}
        MDRectangleFlatButton:
            text: "Reset Password"
            on_press:root.changePasswordMain()
        
        MDRectangleFlatButton:
            text: "Change Name"
            on_press:root.changeNameDbc()
            

    BoxLayout:
        pos_hint:{'y':.305}
        Label:
            id: labelopenedManager
            text: "Manager open:"
            font_size:48

    BoxLayout:
        spacing: 5
        pos_hint:{'center_x':.5, 'y':.733}

        MDRectangleFlatButton:
            text: "Add Records"
            on_press: root.addRecord()
        MDRectangleFlatButton:
            text: "Update Records"
            on_press:root.updateRecordSelected()
        MDRectangleFlatButton:
            text: "Remove Selected"
            on_press: root.removeRecordSelected()

    BoxLayout:
        pos_hint:{'x':.07, 'y':.63}
        spacing:25
        MDRoundFlatIconButton:
            size_hint_x:(None)
            width:20
            text:"Boxes"
            icon: "close"
            on_press:root.clearBoxes()
        MDRectangleFlatButton:
            text: "Search in Table"
            on_press:root.searchRecords()
        MDRoundFlatIconButton:
            size_hint_x:(None)
            width:20
            text:"Tables"
            icon: "refresh"
            on_press:root.querryDataBase()

    BoxLayout:
        orrientation: "horizontal"
        pos_hint: {"y":.68}
        spacing:10
        MDTextField:
            id: name_field
            hint_text: "Site/App"
            multiline: False
            mode: "round"
            size_hint_x: .07 
            size_hint_y:None
            height: "20dp"
            
        MDTextField:
            id: id_field
            hint_text: "Id/E-mail"
            multiline: False
            mode: "round"
            size_hint: 0.12, None
            height: "20dp"

        MDTextField:
            id: password_field
            hint_text: "Password"
            multiline: False
            mode: "round"
            size_hint: 0.1, None
            height: "20dp"

    StackButtonPm:
        id: btnMenu
        type: "small"
        icon: "backburger"
        on_release:
            root.anim_btn()
            root.Exit()
            root.manager.transition.is_active = False
            root.manager.transition.duration = 0
            root.manager.current = "menu"

    StackButtonPm:
        id: btnPss
        type: "small"
        icon: "key-variant"
        on_release: root.PassworGenPopup()
    StackButtonPm:
        id: btnCreateData
        type: "small"
        icon: "script-text-key-outline"
        on_release: root.savefile_manager_open()   
    StackButtonPm:
        id: btnSaveData
        type: "small"
        icon: "content-save-move"
        on_release: root.saveAndExit()

    RootButton:
        id: btn_root_pm
        icon: "menu"
        elevation: 0
        x:"20dp"
        y: "20dp"
        md_bg_color: app.theme_cls.primary_dark
        on_release: root.anim_btn()
    
<AskPassword>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        spacing:10
        Label:
            size_hint_y: None
            height: 100
            text: "keep your password \nminimum length 14"
            halign: 'center'
            font: 40
        MDTextField:
            id: saveName_input
            size_hint_y: None
            hint_text:"Name"
            height: 100
            multiline: False
        ClickableTextFieldRound:
            id: savePassword_input
            size_hint_y: None
            hint_text:"Main Password"
            height: 100
            multiline: False

        Button:
            text: "Submit"
            on_release: root.submit(root.path, saveName_input.text,savePassword_input.text)
            size_hint_y: None
            height:75

<AskName>:
    
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        spacing:10
        Label:
            size_hint_y: None
            height: 100
            text: "it's the file name"
            halign: 'center'
            font: 40
        MDTextField:
            id: text_field
            hint_text: "Name DBC"

        Button:
            text: "Submit"
            on_release: root.submit(root.path, text_field.text, root.filename)
            size_hint_y: None
            height:75


<GenPassword>:
    id:genPP
    BoxLayout:
        pos:root.pos
        orientation:"vertical"
        spacing: 20
        GridLayout:
            pos_hint:{"top": 0.5}
            cols:2
            Label:
                text:"lenght > 14"
                font:40
                size_hint:(None,None)
                width:300
                height:100
                halign:"center"
            MDTextField:
                id:passwordlen
                font:64
                max_text_length: 3
                size_hint:(None,None)
                width:150
                height:100
                input_type: "number"
            
        MDRectangleFlatButton:
            text:"Generate"
            font:40
            pos_hint: {'center_x': .5,'y':.5}
            on_press: root.genPassword(passwordlen.text)
        MDTextField:
            id:passwordgen
            size_hint_y:None
            height:100
            font:64
            on_focus: root.clipboard(passwordgen.text)

<SettsScreen>:
    name:'setts'
    canvas.before:
        Color:
            rgba: (53/255,57/255,60/255,1)
        Rectangle:
            pos: self.pos
            size: self.size
        
    MDIconButton:
        pos_hint:{"top":1,"left":1}
        icon: 'menu'
        on_release:
            root.manager.transition.is_active = False
            root.manager.transition.duration = 0
            root.manager.current = "menu"
    
    BoxLayout:
        pos_hint:{"y":.4,"center_x":.27}
        Label:
            halign:"left"
            text:"Choose Color :"
            text_color: (1,1,1)
            font_size:dp(22)
            bold:True
    GridLayout:
        spacing:20
        cols:3
        rows:2
        pos_hint:{"top":.86,"x":.2}
        MDRectangleFlatButton:
            id:orangebtn
            text:"Orange"
            text_color: "white"
            line_color: "darkorange"
            line_width: 2
            on_release:
                root.changePColor('15')
        MDRectangleFlatButton:
            id:bluebtn
            text:"  Blue  "
            text_color: "white"
            line_color: "blue"
            line_width: 2
            on_release:
                root.changePColor('5')
        MDRectangleFlatButton:
            id:redbtn
            text:"   Red    "
            text_color: "white"
            line_color: "red"
            line_width: 2
            on_release:
                root.changePColor('0')
        MDRectangleFlatButton:
            id:greenbtn
            text:" Green "
            text_color: "white"
            line_color: "green"
            line_width: 2
            on_release:
                root.changePColor('9')
        MDRectangleFlatButton:
            id:purplebtn
            text:"Purple"
            text_color: "white"
            line_color: "purple"
            line_width: 2
            on_release:
                root.changePColor('3')
        MDRectangleFlatButton:
            text:" Other "
            text_color: "white"
            line_color: (1, 1, 1)
            line_width: 2
            on_release:Factory.ColorPopup().open()
    BoxLayout:
        pos_hint:{"y":.2,"center_x":.27}
        Label:
            halign:"left"
            text:"Choose Theme :"
            text_color: (1,1,1)
            font_size:dp(22)
            bold:True
    GridLayout:
        spacing:20
        cols:3
        rows:2
        pos_hint:{"top":.66,"x":.33}
        MDRectangleFlatButton:
            text:"Dark "
            text_color: "white"
            md_bg_color: "black"
            line_color: (0, 0, 0)
            line_width: 2
            on_release:
                root.changeTheme('Dark')
        MDRectangleFlatButton:
            text:"Light"
            text_color: "black"
            md_bg_color: "white"
            line_color: (1, 1, 1)
            line_width: 2
            on_release:
                root.changeTheme('Light')


<SeedScreen>:
    name:'seed'
    canvas.before:
        Color:
            rgba: (53/255,57/255,60/255,1)
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        pos_hint:{'y':.465}
        halign: 'center'
        size: root.size
        Label:
            text: "SeedPhrase Manager"
            halign: 'center'
            font_size:80
            bold: True
            color:  (1,1,1,1)        #(255/255,153/255,0/255,1)
            outline_width: 1
            outline_color: (0,0,0)
    MDSeparator:
        pos_hint:{'y':.935}
        width:2
        color: (255/255,1,1,1)
    
    ClickableTextFieldRound:
        id:mainPassword  
        size_hint_x: .45
        #width: 500
        pos_hint:{'x':.05, 'y':.86}
        hint_text:"Main Password"
        

    GridLayout:
        orrientation: "horizontal"
        cols:2
        spacing: 15
        pos_hint:{'x':.55,'top':.924}


        MDRectangleFlatButton:
            id: browseSeedPhraseBtn
            text: "Browse"
            on_press:root.loadfile_SeedPhrase_open()
        MDRectangleFlatButton:
            id: openSeedInBtn
            text: "Open"
            on_release:root.openSeedPhrase()
    
    BoxLayout:
        spacing:10
        pos_hint:{'y':.825,'x':.194}
        MDRectangleFlatButton:
            text: "Reset Password"
            on_press:root.changePasswordMain()
        
        MDRectangleFlatButton:
            text: "Change Name"
            on_press:root.changeNameDbc()
    
    BoxLayout:
        pos_hint:{'y':.305}
        Label:
            id: labelopenedSManager
            text: "Seeds open:"
            font_size:48

    GridLayout:
        orrientation: "horizontal"
        cols:2
        rows:12
        row_force_default:True
        row_default_height:125
        col_force_default:True
        col_default_width:500
        spacing:10
        pos_hint:{'x':.05,'top':.79}

        MDTextField:
            id: text_field1
            hint_text: "Word 1"
        MDTextField:
            id: text_field2
            hint_text: "Word 2"
        MDTextField:
            id: text_field3
            hint_text: "Word 3"
        MDTextField:
            id: text_field4
            hint_text: "Word 4"
        MDTextField:
            id: text_field5
            hint_text: "Word 5"
        MDTextField:
            id: text_field6
            hint_text: "Word 6"
        
        MDTextField:
            id: text_field7
            hint_text: "Word 7"
        MDTextField:
            id: text_field8
            hint_text: "Word 8"
        MDTextField:
            id: text_field9
            hint_text: "Word 9"
        MDTextField:
            id: text_field10
            hint_text: "Word 10"
        MDTextField:
            id: text_field11
            hint_text: "Word 11"
        MDTextField:
            id: text_field12
            hint_text: "Word 12"
        
        MDTextField:
            id: text_field13
            hint_text: "Word 13"
        MDTextField:
            id: text_field14
            hint_text: "Word 14"
        MDTextField:
            id: text_field15
            hint_text: "Word 15"
        MDTextField:
            id: text_field16
            hint_text: "Word 16"
        MDTextField:
            id: text_field17
            hint_text: "Word 17"
        MDTextField:
            id: text_field18
            hint_text: "Word 18"
        
        MDTextField:
            id: text_field19
            hint_text: "Word 19"
        MDTextField:
            id: text_field20
            hint_text: "Word 20"
        MDTextField:
            id: text_field21
            hint_text: "Word 21"
        MDTextField:
            id: text_field22
            hint_text: "Word 22"
        MDTextField:
            id: text_field23
            hint_text: "Word 23"
        MDTextField:
            id: text_field24
            hint_text: "Word 24"

        

    StackButtonPm:
        id: btnMenu
        type: "small"
        icon: "backburger"
        x:"300dp"
        on_release:
            root.anim_btn()
            root.manager.transition.is_active = False
            root.manager.transition.duration = 0
            root.manager.current = "menu"
    StackButtonPm:
        id: btnCreateData
        x:"300dp"
        type: "small"
        icon: "script-text-key-outline"
        on_release: root.savefile_seedPhrase_open()
    
    StackButtonPm:
        id: btnPss
        x:"300dp"
        icon: "key-variant"
        on_release: root.PassworGenPopup()
    
    StackButtonPm:
        id: btnSaveData
        type: "small"
        x:"300dp"
        icon: "content-save-move"
        on_release: root.saveAndExit()

    RootButton:
        id: btn_root_pm
        icon: "menu"
        elevation: 0
        x:"300dp"
        y: "20dp"
        md_bg_color: app.theme_cls.primary_dark
        on_release: root.anim_btn()
